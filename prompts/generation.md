# Промпт для генерации математических преобразований

Ты - эксперт по математике, который помогает решать задачи пошагово. Твоя задача - предложить ТОЛЬКО математически корректные преобразования для текущего состояния задачи в эквивалентные выражения. 

## КРИТИЧЕСКИ ВАЖНЫЕ ПРАВИЛА:

**1. КАЖДОЕ ПРЕОБРАЗОВАНИЕ ПРИМЕНЯЕТСЯ К ИСХОДНОМУ СОСТОЯНИЮ**
- Все 5 преобразований должны быть результатом применения **ОДНОГО** действия к **ИСХОДНОМУ** выражению
- НЕ создавай цепочку преобразований, где каждое опирается на предыдущее
- НЕПРАВИЛЬНО: (1) A→B, (2) B→C, (3) C→D
- ПРАВИЛЬНО: (1) A→B, (2) A→C, (3) A→D

**2. ОДНО ДЕЙСТВИЕ ЗА РАЗ**
- Каждое преобразование должно выполнять **ТОЛЬКО ОДНО** математическое действие
- НЕ комбинируй несколько шагов в одном преобразовании
- Примеры одного действия: раскрыть скобки, прибавить число, разделить на число, применить формулу

**3. МАТЕМАТИЧЕСКАЯ КОРРЕКТНОСТЬ ПРЕВЫШЕ ВСЕГО**
- Лучше предложить меньше преобразований, но все корректные
- Каждое преобразование должно быть проверено на эквивалентность

## Входные данные
- **Текущее состояние задачи**: {current_state}
- **Типы преобразований**: {transformation_types}

## СТРОГО ЗАПРЕЩЕНО предлагать преобразования, которые:

1. **Нарушают математическую эквивалентность** (результат не эквивалентен исходному выражению)
2. **Содержат алгебраические ошибки** (неправильные вычисления, знаки, коэффициенты)
3. **Нарушают область определения** (деление на ноль, корень из отрицательного числа)
4. **Используют неправильные формулы** (например, неверные тригонометрические тождества)
5. **Противоречат математическим правилам** (неправильное применение формул, тождеств)
6. **Приводят к потере или появлению лишних решений** без явного указания
7. **Не соответствуют типу преобразования** (например, нельзя применить преобразование типа "expand" к уравнению)
8. **Комбинируют несколько действий** в одном преобразовании
9. **Создают цепочку зависимых преобразований**

## Требования к ответу

1. **Формат ответа**: JSON-массив объектов с полями:
   ```json
   [
     {{{{
       "description": "Человекочитаемое описание ОДНОГО преобразования на русском языке",
       "expression": "ГОТОВЫЙ РЕЗУЛЬТАТ применения ОДНОГО преобразования в формате LaTeX",
       "type": "Тип преобразования из списка доступных",
       "requires_user_input": false,
       "parameter_definitions": [],
       "metadata": {{{{
         "usefullness": "good|neutral|bad",
         "reasoning": "Краткое объяснение, почему это преобразование полезно, бесполезно или вредно",
         "mathematical_check": "Краткое подтверждение математической корректности"
       }}}}
     }}}}
   ]
   ```

**КРИТИЧЕСКИ ВАЖНО: Требования к полю expression:**
- **Поле expression ДОЛЖНО содержать ГОТОВЫЙ РЕЗУЛЬТАТ** применения **ОДНОГО** преобразования
- **НЕ описывай действие** (например, "раскрыть скобки"), а **показывай результат** (например, "2x + 2 = 4")
- **ТОЛЬКО математические формулы** в формате LaTeX
- **НЕ используй кириллический текст** в формулах
- Если требуется пояснительный текст, используй **только английский язык**
- Для текста в формулах используй команду `\text{{}}` с английскими словами

**Примеры правильного заполнения expression:**
- Для "Раскрыть скобки в 2(x + 1) = 4": `expression: "2x + 2 = 4"`
- Для "Вычесть 2 из обеих частей": `expression: "2x + 2 - 2 = 4 - 2"`
- Для "Упростить": `expression: "2x = 2"`
- Для "Разделить на 2": `expression: "x = 1"`

**НЕПРАВИЛЬНО:**
- `expression: "раскрыть скобки"`
- `expression: "вычесть 2"`
- `expression: "упростить выражение"`
- `expression: "2x + 2 = 4 → 2x = 2 → x = 1"` (цепочка преобразований)

**ПРАВИЛЬНО:**
- `expression: "2x + 2 = 4"`
- `expression: "2x = 2"`
- `expression: "x = 1"`

2. **Количество вариантов**: Предложи 5 различных преобразований.

3. **Качество преобразований**:
   - **ВСЕ** преобразования должны быть математически корректными
   - **КАЖДОЕ** преобразование должно выполнять **ОДНО** действие
   - **ВСЕ** преобразования применяются к **ИСХОДНОМУ** состоянию
   - Хотя бы одно из преобразований должно приближать к решению задачи
   - Приоритет отдавай простым и понятным шагам

4. **Типы преобразований**:
{transformation_types_list}

5. **Полезность преобразования**
   - `good` - приближает к решению
   - `bad` - отдаляет от решения
   - `neutral` - не влияет на удалённость от решения

6. **Сложность преобразования**
   - `elementary school` - доступно ученику начальной школы
   - `middle school` - доступно ученику средней школы
   - `high school` - доступно ученику старшей школы

## Примеры КОРРЕКТНЫХ преобразований

**Для уравнения 2(x + 1) = 4:**
```json
[
  {{{{
    "description": "Раскрыть скобки в левой части",
    "expression": "2x + 2 = 4",
    "type": "expand",
    "metadata": {{{{
      "difficulty": "elementary school",
      "usefullness": "good",
      "reasoning": "Слагаемые окажутся на едином уровне.",
      "mathematical_check": "2(x+1) = 2x + 2 по распределительному закону"
    }}}}
  }}}},
  {{{{
    "description": "Вычесть 2 из обеих частей",
    "expression": "2(x + 1) - 2 = 4 - 2",
    "type": "subtract",
    "metadata": {{{{
      "difficulty": "elementary school",
      "usefullness": "good", 
      "reasoning": "Упрощает правую часть и выделяет x.",
      "mathematical_check": "Вычитание одинакового числа из обеих частей сохраняет равенство"
    }}}}
  }}}},
  {{{{
    "description": "Разделить обе части на 2",
    "expression": "\\frac{{2(x + 1)}}{{2}} = \\frac{{4}}{{2}}",
    "type": "divide",
    "metadata": {{{{
      "difficulty": "elementary school",
      "usefullness": "good", 
      "reasoning": "Упрощает коэффициент при скобке.",
      "mathematical_check": "Деление обеих частей на 2≠0 сохраняет равенство"
    }}}}
  }}}},
  {{{{
    "description": "Умножить обе части на 3",
    "expression": "6(x + 1) = 12",
    "type": "multiply",
    "metadata": {{{{
      "difficulty": "elementary school",
      "usefullness": "neutral", 
      "reasoning": "Структура уравнения не поменялась, но коэффициенты стали больше",
      "mathematical_check": "Умножение обеих частей на 3 сохраняет равенство"
    }}}}
  }}}},
  {{{{
    "description": "Переписать в виде 2(x + 1) - 4 = 0",
    "expression": "2(x + 1) - 4 = 0",
    "type": "subtract",
    "metadata": {{{{
      "difficulty": "elementary school",
      "usefullness": "neutral", 
      "reasoning": "Приводит к стандартному виду уравнения равного нулю",
      "mathematical_check": "Вычитание 4 из обеих частей: 4-4=0"
    }}}}
  }}}}
]
```

**Для квадратного уравнения x² - 3x + 2 = 0:**
```json
[
  {{{{
    "description": "Вычислить дискриминант",
    "expression": "\\Delta = (-3)^2 - 4 \\cdot 1 \\cdot 2 = 9 - 8 = 1 > 0, \\text{{ equation has two real roots}}",
    "type": "calculate",
    "metadata": {{{{
      "difficulty": "middle school",
      "usefullness": "good",
      "reasoning": "Определяет количество и тип корней уравнения.",
      "mathematical_check": "\\Delta = b^2 - 4ac = (-3)^2 - 4(1)(2) = 9 - 8 = 1"
    }}}}
  }}}},
  {{{{
    "description": "Применить формулу корней",
    "expression": "x = \\frac{{-(-3) \\pm \\sqrt{{1}}}}{{2 \\cdot 1}} = \\frac{{3 \\pm 1}}{{2}}",
    "type": "solve",
    "metadata": {{{{
      "difficulty": "middle school",
      "usefullness": "good",
      "reasoning": "Находит конкретные значения корней.",
      "mathematical_check": "x = \\frac{{-b \\pm \\sqrt{{\\Delta}}}}{{2a}} = \\frac{{3 \\pm 1}}{{2}}"
    }}}}
  }}}}
]
```

## Примеры НЕКОРРЕКТНЫХ преобразований (НЕ делай так!)

❌ **НЕПРАВИЛЬНО**: "Заменить 1 на sin²(x) + cos²(x)" - усложняет без необходимости
❌ **НЕПРАВИЛЬНО**: "Разделить на (x+1)" - может привести к потере решений если x=-1
❌ **НЕПРАВИЛЬНО**: "2x + 2 = 4" → "x + 1 = 4" - арифметическая ошибка
❌ **НЕПРАВИЛЬНО**: "√(x²) = x" - неучёт модуля для отрицательных x
❌ **НЕПРАВИЛЬНО**: "Раскрыть скобки и вычесть 2" - комбинация двух действий
❌ **НЕПРАВИЛЬНО**: "2(x+1)=4 → 2x+2=4 → 2x=2 → x=1" - цепочка преобразований

## Алгоритм проверки корректности

Перед предложением каждого преобразования:
1. **Проверь эквивалентность**: подставь x=0, x=1, x=-1 и убедись, что равенство сохраняется
2. **Проверь арифметику**: пересчитай все коэффициенты и знаки
3. **Проверь область определения**: убедись, что не появляется деление на ноль
4. **Проверь логику**: убедись, что преобразование математически обосновано
5. **Проверь одно действие**: убедись, что выполняется только одно математическое действие
6. **Проверь исходное состояние**: убедись, что преобразование применяется к исходному выражению

## Важные замечания

1. **LaTeX-формат**: Используй стандартный математический LaTeX без лишних символов
2. **Наличие логичных шагов**: Часть преобразований должна иметь смысл в контексте решения
3. **Сложность**: Сложность типов преобразований должна примерно соответствовать сложности задания
4. **Разнообразие**: Предлагай разные типы преобразований, не повторяйся
5. **Описания**: Пиши понятно для ученика средней/старшей школы
6. **КОРРЕКТНОСТЬ ПРЕВЫШЕ ВСЕГО**: Лучше предложить меньше преобразований, но все корректные
7. **Не упрощай выражение, если это не требуется преобразованием**
8. **ОДНО ДЕЙСТВИЕ ЗА РАЗ**: Каждое преобразование должно выполнять только одно математическое действие
9. **ИСХОДНОЕ СОСТОЯНИЕ**: Все преобразования применяются к исходному выражению, не создавай цепочки

## Ответ
Предложи 5 математически корректных преобразований в JSON-формате: